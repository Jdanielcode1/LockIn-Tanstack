name = "video-processor-container"
main = "worker.js"
compatibility_date = "2024-01-01"

# Enable container logs
[observability]
enabled = true

# Container configuration
[[containers]]
class_name = "VideoProcessor"
image = "./Dockerfile"
max_instances = 10

[[durable_objects.bindings]]
class_name = "VideoProcessor"
name = "VIDEO_PROCESSOR"

[[migrations]]
new_sqlite_classes = ["VideoProcessor"]
tag = "v1"

# Cloudflare AI binding
[ai]
binding = "AI"

# R2 bucket binding for thumbnail uploads
[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "lock-in-bucket-2"

# Environment variables (set using wrangler secret put)
# R2_ENDPOINT, R2_ACCESS_KEY_ID, R2_SECRET_ACCESS_KEY, R2_BUCKET_NAME, CONVEX_URL
# Run: wrangler secret put R2_ENDPOINT
#      wrangler secret put R2_ACCESS_KEY_ID
#      wrangler secret put R2_SECRET_ACCESS_KEY
#      wrangler secret put R2_BUCKET_NAME
#      wrangler secret put CONVEX_URL
